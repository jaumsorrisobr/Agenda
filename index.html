<!DOCTYPE html>
<html lang="pt-br">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <title>Agenda Medicine - Turma H</title>
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
Â  Â  <meta name="apple-mobile-web-app-capable" content="yes">
Â  Â  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
Â  Â  <meta name="theme-color" content="#007bff">

Â  Â  <style>
Â  Â  Â  Â  :root { --p-med: #007bff; --bg: #121212; --card-bg: #1e1e1e; --text-color: #e0e0e0; --shadow: rgba(0,0,0,0.5); --input-bg: #2d2d2d; }
Â  Â  Â  Â  [data-theme="light"] { --bg: #f4f7f6; --card-bg: #ffffff; --text-color: #333333; --shadow: rgba(0,0,0,0.1); --input-bg: #eeeeee; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
Â  Â  Â  Â  body { font-family: -apple-system, system-ui, sans-serif; background: var(--bg); margin: 0; padding: 20px; color: var(--text-color); transition: background 0.3s; padding-bottom: 60px; }

Â  Â  Â  Â  /* AJUSTE PARA EVITAR ZOOM NO IOS */
Â  Â  Â  Â  input, textarea, button { font-size: 16px !important; }

Â  Â  Â  Â  /* Splash */
Â  Â  Â  Â  #splash { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #ffffff; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10000; transition: opacity 0.8s ease; }
Â  Â  Â  Â  .logo-pulsando { width: 120px; animation: pulsar 2s infinite ease-in-out; }
Â  Â  Â  Â  @keyframes pulsar { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.1); opacity: 0.7; } }

Â  Â  Â  Â  .header { text-align: center; margin-bottom: 20px; }
Â  Â  Â  Â  #status-bar { font-size: 0.8em; color: #888; margin-top: 5px; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Grid */
Â  Â  Â  Â  .grid-container { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
Â  Â  Â  Â  .card { background: var(--card-bg); height: 110px; border-radius: 15px; box-shadow: 0 4px 6px var(--shadow); cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; font-weight: 600; border: 1px solid rgba(255,255,255,0.05); }
Â  Â  Â  Â  .card .icon { font-size: 1.8em; margin-bottom: 8px; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Modal */
Â  Â  Â  Â  .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); align-items: center; justify-content: center; padding: 15px; z-index: 2000; backdrop-filter: blur(8px); }
Â  Â  Â  Â  .modal-content { background: var(--card-bg); padding: 20px; border-radius: 25px; width: 100%; max-width: 450px; max-height: 85vh; overflow-y: auto; position: relative; border: 1px solid rgba(0,123,255,0.3); }
Â  Â  Â  Â  .close-btn { position: absolute; top: 15px; right: 20px; background: none; border: none; font-size: 28px; color: var(--text-color); }
Â  Â  Â  Â  .search-container {
Â  Â  position: sticky;
Â  Â  top: -20px; /* Gruda no topo do modal */
Â  Â  background: var(--card-bg);
Â  Â  padding: 10px 0;
Â  Â  z-index: 10;
Â  Â  margin-bottom: 10px;
}

.search-input {
Â  Â  width: 100%;
Â  Â  padding: 12px;
Â  Â  border-radius: 10px;
Â  Â  border: 1px solid var(--p-med);
Â  Â  background: var(--input-bg);
Â  Â  color: var(--text-color);
Â  Â  outline: none;
}
Â  Â  Â  Â  /* Listas e Grade */
Â  Â  Â  Â  .secao-retratil { margin-bottom: 12px; border-radius: 15px; background: rgba(255,255,255,0.03); border: 1px solid var(--shadow); overflow: hidden; }
Â  Â  Â  Â  .secao-titulo { background: rgba(0,123,255,0.12); color: var(--p-med); padding: 14px 18px; font-weight: 800; font-size: 0.85em; text-transform: uppercase; cursor: pointer; display: flex; justify-content: space-between; align-items: center; list-style: none; }
Â  Â  Â  Â  .secao-titulo::-webkit-details-marker { display: none; }

Â  Â  Â  Â  .grade-item { display: flex; align-items: center; gap: 12px; padding: 12px 15px; border-bottom: 1px solid rgba(128,128,128,0.1); }
Â  Â  Â  Â  .grade-hora { flex: 0 0 100px; color: #fff; font-weight: 800; font-size: 0.75em; text-align: center; background: var(--p-med); padding: 5px; border-radius: 6px; }
Â  Â  Â  Â  .grade-info { flex: 1; text-align: left; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .item-lista { display: flex; justify-content: space-between; align-items: center; padding: 16px; background: var(--input-bg); border-radius: 12px; margin: 8px 0; text-decoration: none; color: var(--text-color); width: 100%; }
Â  Â  Â  Â  .arquivo-nome { font-weight: bold; text-align: left; flex: 1; margin-right: 10px; }
Â  Â  Â  Â  .link-vazio { color: #ffa500; font-size: 0.75em; font-style: italic; white-space: nowrap; }

Â  Â  Â  Â  #theme-toggle { position: fixed; bottom: 25px; right: 25px; background: var(--card-bg); border: 2px solid var(--p-med); border-radius: 50%; width: 55px; height: 55px; display: flex; align-items: center; justify-content: center; z-index: 999; box-shadow: 0 4px 15px rgba(0,0,0,0.4); }
Â  Â  </style>
</head>
<body data-theme="dark">

<div id="splash">
Â  Â  <img src="logo_UCP.png" class="logo-pulsando" onerror="this.src='https://via.placeholder.com/150?text=MED+UCP'">
Â  Â  <h2 style="color:#007bff; margin-top: 15px; font-weight: 900;">MEDICINA - UCP</h2>
</div>

<button id="theme-toggle" onclick="toggleTheme()"><span id="theme-icon">ğŸŒ™</span></button>

<div class="header">
Â  Â  <h2 style="margin:0; letter-spacing: -1px;">Medicina - Turma H</h2>
Â  Â  <div id="status-bar">Sincronizando...</div>
</div>

<div class="grid-container">
Â  Â  <div class="card" onclick="abrirGrade()"><span class="icon">ğŸ“…</span><span>Grade</span></div>
Â  Â  <div class="card" onclick="abrirGrupos()"><span class="icon">ğŸ‘¥</span><span>Grupos</span></div>
Â  Â  <div class="card" onclick="abrirAvisos()"><span class="icon">ğŸ””</span><span>Avisos</span></div>
Â  Â  <div class="card" onclick="abrirArquivos()"><span class="icon">ğŸ“„</span><span>Arquivos</span></div>
Â  Â  <div id="btnAulasOnline" class="card" onclick="abrirLinks()" style="grid-column: span 2; height: 85px; flex-direction: row; gap: 15px;">
Â  Â  Â  Â  <span class="icon">ğŸ’»</span><span>Aulas Online</span>
Â  Â  </div>
</div>

<div id="meuModal" class="modal">
Â  Â  <div class="modal-content">
Â  Â  Â  Â  <button class="close-btn" onclick="fecharModal()">âœ•</button>
Â  Â  Â  Â  <h3 id="modal-titulo" style="margin-bottom:20px; color:var(--p-med); padding-right: 30px;"></h3>
Â  Â  Â  Â  <div id="modal-corpo"></div>
Â  Â  </div>
</div>

<div id="modalLinkAdmin" class="modal">
Â  Â  <div class="modal-content">
Â  Â  Â  Â  <button class="close-btn" onclick="this.parentElement.parentElement.style.display='none'">âœ•</button>
Â  Â  Â  Â  <h3 style="color:#28a745;">Postar Aula Online</h3>
Â  Â  Â  Â  <input type="password" id="senhaLink" placeholder="Senha do Representante" style="width:100%; padding:12px; margin-bottom:10px; border-radius:8px; border:1px solid #444; background:#2d2d2d; color:white;">
Â  Â  Â  Â  <input type="text" id="dataLink" placeholder="Data (DD/MM/AAAA)" style="width:100%; padding:12px; margin-bottom:10px; border-radius:8px; border:1px solid #444; background:#2d2d2d; color:white;">
Â  Â  Â  Â  <input type="text" id="horaLink" placeholder="HorÃ¡rio (HH:MM)" style="width:100%; padding:12px; margin-bottom:10px; border-radius:8px; border:1px solid #444; background:#2d2d2d; color:white;">
Â  Â  Â  Â  <input type="text" id="materiaLink" placeholder="MatÃ©ria" style="width:100%; padding:12px; margin-bottom:10px; border-radius:8px; border:1px solid #444; background:#2d2d2d; color:white;">
Â  Â  Â  Â  <input type="text" id="urlLink" placeholder="Link (URL)" style="width:100%; padding:12px; margin-bottom:10px; border-radius:8px; border:1px solid #444; background:#2d2d2d; color:white;">
Â  Â  Â  Â  <button onclick="enviarDados('Links')" style="width:100%; padding:15px; background:#28a745; color:white; border:none; border-radius:10px; font-weight:bold;">ENVIAR AULA</button>
Â  Â  Â  Â  <div id="msgLink" style="margin-top:10px; text-align:center; font-weight:bold;"></div>
Â  Â  </div>
</div>

<div id="modalAvisoAdmin" class="modal">
Â  Â  <div class="modal-content">
Â  Â  Â  Â  <button class="close-btn" onclick="this.parentElement.parentElement.style.display='none'">âœ•</button>
Â  Â  Â  Â  <h3 style="color:#ffc107;">Postar Novo Aviso</h3>
Â  Â  Â  Â  <input type="password" id="senhaAviso" placeholder="Senha do Representante" style="width:100%; padding:12px; margin-bottom:10px; border-radius:8px; border:1px solid #444; background:#2d2d2d; color:white;">
Â  Â  Â  Â  <input type="text" id="tituloAviso" placeholder="TÃ­tulo do Aviso" style="width:100%; padding:12px; margin-bottom:10px; border-radius:8px; border:1px solid #444; background:#2d2d2d; color:white;">
Â  Â  Â  Â  <textarea id="textoAviso" placeholder="Mensagem do aviso..." rows="4" style="width:100%; padding:12px; margin-bottom:10px; border-radius:8px; border:1px solid #444; background:#2d2d2d; color:white; font-family:sans-serif;"></textarea>
Â  Â  Â  Â  <button onclick="enviarDados('Avisos')" style="width:100%; padding:15px; background:#ffc107; color:black; border:none; border-radius:10px; font-weight:bold;">POSTAR AVISO</button>
Â  Â  Â  Â  <div id="msgAviso" style="margin-top:10px; text-align:center; font-weight:bold;"></div>
Â  Â  </div>
</div>

<div class="footer-creditos" id="btnAdmin" style="text-align: center; font-size: 11px; color: #888; margin-top: 40px; cursor: pointer;">
Â  Â  Desenvolvido por JoÃ£o Vitor FrÃ³is Sanchez
</div>

<script>
Â  Â  const URL_API = "https://script.google.com/macros/s/AKfycbxDt1R5Gpu2aDY5dts6aDQcigKLx28ZxjmXynrvOvmGmvwaG86xBQmOABbn_BsKsUNP7A/exec";
Â  Â  let dadosApp = {};
Â  Â  let timerAdmin;
Â  Â  let timerPlanilha;

Â  Â  // ConfiguraÃ§Ã£o do gatilho de 5 segundos ao carregar
Â  Â  window.onload = () => {
Â  Â  Â  Â  carregarDados();
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Timer Painel Aulas Online
Â  Â  Â  Â  const btnAulas = document.getElementById('btnAulasOnline');
Â  Â  Â  Â  const ligarTimerLink = () => {
Â  Â  Â  Â  Â  Â  timerPlanilha = setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('modalLinkAdmin').style.display = 'flex';
Â  Â  Â  Â  Â  Â  }, 5000);
Â  Â  Â  Â  };
Â  Â  Â  Â  btnAulas.addEventListener('touchstart', ligarTimerLink);
Â  Â  Â  Â  btnAulas.addEventListener('mousedown', ligarTimerLink);
Â  Â  Â  Â  btnAulas.addEventListener('touchend', () => clearTimeout(timerPlanilha));
Â  Â  Â  Â  btnAulas.addEventListener('mouseup', () => clearTimeout(timerPlanilha));

Â  Â  Â  Â  // Timer Painel Avisos
Â  Â  Â  Â  const btnCreditos = document.getElementById('btnAdmin');
Â  Â  Â  Â  const ligarTimerAviso = () => {
Â  Â  Â  Â  Â  Â  timerAdmin = setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('modalAvisoAdmin').style.display = 'flex';
Â  Â  Â  Â  Â  Â  }, 5000);
Â  Â  Â  Â  };
Â  Â  Â  Â  btnCreditos.addEventListener('touchstart', ligarTimerAviso);
Â  Â  Â  Â  btnCreditos.addEventListener('mousedown', ligarTimerAviso);
Â  Â  Â  Â  btnCreditos.addEventListener('touchend', () => clearTimeout(timerAdmin));
Â  Â  Â  Â  btnCreditos.addEventListener('mouseup', () => clearTimeout(timerAdmin));

Â  Â  Â  Â  // Splash Timeout
Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  const splash = document.getElementById('splash');
Â  Â  Â  Â  Â  Â  splash.style.opacity = '0';
Â  Â  Â  Â  Â  Â  setTimeout(() => splash.style.display = 'none', 800);
Â  Â  Â  Â  }, 2000);
Â  Â  };

Â  Â  async function carregarDados() {
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  const res = await fetch(`${URL_API}?t=${new Date().getTime()}`);
Â  Â  Â  Â  Â  Â  dadosApp = await res.json();
Â  Â  Â  Â  Â  Â  localStorage.setItem('med_h_cache', JSON.stringify(dadosApp));
Â  Â  Â  Â  Â  Â  document.getElementById('status-bar').innerText = `Atualizado: ${dadosApp.ultima_sincronizacao || 'Agora'}`;
Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  dadosApp = JSON.parse(localStorage.getItem('med_h_cache') || "{}");
Â  Â  Â  Â  Â  Â  document.getElementById('status-bar').innerText = "Modo Offline";
Â  Â  Â  Â  }
Â  Â  }

Â  Â  // FunÃ§Ãµes Gerais
Â  Â  function fecharModal() { document.getElementById('meuModal').style.display = 'none'; }
Â  Â Â 
Â  Â  function toggleTheme() {
Â  Â  Â  Â  const n = document.body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
Â  Â  Â  Â  document.body.setAttribute('data-theme', n);
Â  Â  Â  Â  document.getElementById('theme-icon').innerText = n === 'dark' ? 'ğŸŒ™' : 'ğŸ’¡';
Â  Â  Â  Â  localStorage.setItem('med_h_theme', n);
Â  Â  }

Â  Â  function setupAccordion(grupo) {
Â  Â  Â  Â  const detalhes = document.querySelectorAll(`details[name="${grupo}"]`);
Â  Â  Â  Â  detalhes.forEach(targetDetail => {
Â  Â  Â  Â  Â  Â  targetDetail.onclick = () => {
Â  Â  Â  Â  Â  Â  Â  Â  detalhes.forEach(detail => { if (detail !== targetDetail) detail.removeAttribute("open"); });
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  });
Â  Â  }

Â  Â  function formatarDataBR(dataStr) {
Â  Â  Â  Â  if(!dataStr) return "";
Â  Â  Â  Â  const d = new Date(dataStr);
Â  Â  Â  Â  return isNaN(d.getTime()) ? dataStr : d.toLocaleDateString('pt-BR');
Â  Â  }

Â  Â  // Abertura de SeÃ§Ãµes
Â  Â  function abrirGrade() {
Â  Â  Â  Â  const corpo = document.getElementById('modal-corpo');
Â  Â  Â  Â  document.getElementById('modal-titulo').innerText = "Grade de Aulas";
Â  Â  Â  Â  corpo.innerHTML = "";
Â  Â  Â  Â  const itens = dadosApp["Grade"] || [];
Â  Â  Â  Â  const ordemReferencia = ["Segunda", "TerÃ§a", "Quarta", "Quinta", "Sexta", "SÃ¡bado", "Domingo"];
Â  Â  Â  Â  const dias = [...new Set(itens.map(a => a["Dia da Semana"]))].sort((a, b) =>Â 
Â  Â  Â  Â  Â  Â  ordemReferencia.findIndex(dia => a.includes(dia)) - ordemReferencia.findIndex(dia => b.includes(dia))
Â  Â  Â  Â  );
Â  Â  Â  Â  dias.forEach(dia => {
Â  Â  Â  Â  Â  Â  const aulas = itens.filter(a => a["Dia da Semana"] === dia);
Â  Â  Â  Â  Â  Â  let html = aulas.map(a => `<div class="grade-item"><div class="grade-hora">${a["HorÃ¡rios"]}</div><div class="grade-info"><b>${a["MatÃ©ria"]}</b><br><small>ğŸ‘¥ ${a["Grupo"] || 'Geral'}</small></div></div>`).join('');
Â  Â  Â  Â  Â  Â  corpo.innerHTML += `<details class="secao-retratil" name="grade"><summary class="secao-titulo">${dia} <span>â–¾</span></summary><div>${html}</div></details>`;
Â  Â  Â  Â  });
Â  Â  Â  Â  document.getElementById('meuModal').style.display = 'flex';
Â  Â  Â  Â  setupAccordion("grade");
Â  Â  }

Â  Â  function abrirAvisos() {
Â  Â  Â  Â  const corpo = document.getElementById('modal-corpo');
Â  Â  Â  Â  document.getElementById('modal-titulo').innerText = "Avisos";
Â  Â  Â  Â  const itens = (dadosApp["Avisos"] || []).slice().reverse();
Â  Â  Â  Â  corpo.innerHTML = itens.map(i => `<div style="background:rgba(0,123,255,0.05); padding:15px; border-radius:12px; margin-bottom:12px; border-left: 4px solid var(--p-med);"><div style="font-size: 0.75em; color: #888;">${formatarDataBR(i["Data"])}</div><div style="font-weight:800; color:var(--p-med); text-transform:uppercase;">${i["Titulo"]}</div><div style="white-space:pre-wrap; margin-top:5px;">${i["Mensagem"]}</div></div>`).join('');
Â  Â  Â  Â  document.getElementById('meuModal').style.display = 'flex';
Â  Â  }

Â  Â  function abrirArquivos() {
Â  Â  Â  Â  const corpo = document.getElementById('modal-corpo');
Â  Â  Â  Â  document.getElementById('modal-titulo').innerText = "Arquivos";
Â  Â  Â  Â  corpo.innerHTML = "";
Â  Â  Â  Â  const itens = dadosApp["Arquivos"] || [];
Â  Â  Â  Â  [...new Set(itens.map(i => i["Nome"]))].forEach(n => {
Â  Â  Â  Â  Â  Â  const links = itens.filter(i => i["Nome"] === n);
Â  Â  Â  Â  Â  Â  let html = links.map(a => {
Â  Â  Â  Â  Â  Â  Â  Â  const temLink = a["Links"] && String(a["Links"]).includes("http");
Â  Â  Â  Â  Â  Â  Â  Â  return `<${temLink ? 'a href="'+a["Links"]+'" target="_blank"' : 'div'} class="item-lista"><b>${a["DescriÃ§Ã£o"]}</b>${temLink ? '<span>ğŸ“‚</span>' : '<span class="link-vazio">â³ Aguardando</span>'}</${temLink ? 'a' : 'div'}>`;
Â  Â  Â  Â  Â  Â  }).join('');
Â  Â  Â  Â  Â  Â  corpo.innerHTML += `<details class="secao-retratil" name="arqs"><summary class="secao-titulo">${n} <span>â–¾</span></summary><div style="padding:5px 10px;">${html}</div></details>`;
Â  Â  Â  Â  });
Â  Â  Â  Â  document.getElementById('meuModal').style.display = 'flex';
Â  Â  Â  Â  setupAccordion("arqs");
Â  Â  }

Â  Â  function abrirGrupos() {
Â  Â  const corpo = document.getElementById('modal-corpo');
Â  Â  document.getElementById('modal-titulo').innerText = "Grupos e Integrantes";
Â  Â Â 
Â  Â  corpo.innerHTML = `
Â  Â  Â  Â  <div class="search-container">
Â  Â  Â  Â  Â  Â  <input type="text" id="inputBusca" class="search-input" placeholder="ğŸ” Digite um nome ou matÃ©ria..." onkeyup="filtrarGrupos()">
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div id="container-grupos"></div>
Â  Â  `;

Â  Â  renderizarGrupos(dadosApp["Grupos"] || []);
Â  Â  document.getElementById('meuModal').style.display = 'flex';
}

function renderizarGrupos(lista) {
Â  Â  const container = document.getElementById('container-grupos');
Â  Â  const termoBusca = document.getElementById('inputBusca') ? document.getElementById('inputBusca').value : "";
Â  Â  container.innerHTML = "";
Â  Â Â 
Â  Â  if (lista.length === 0) {
Â  Â  Â  Â  container.innerHTML = "<p style='text-align:center; opacity:0.5;'>Nenhum resultado encontrado.</p>";
Â  Â  Â  Â  return;
Â  Â  }

Â  Â  const materias = [...new Set(lista.map(i => i["MatÃ©ria"]))];
Â  Â Â 
Â  Â  materias.forEach(mat => {
Â  Â  Â  Â  const gruposMat = lista.filter(i => i["MatÃ©ria"] === mat);
Â  Â  Â  Â  const nomesG = [...new Set(gruposMat.map(g => g["Nome do Grupo"]))];
Â  Â  Â  Â  const statusOpen = termoBusca.length > 0 ? "open" : "";
Â  Â  Â  Â Â 
Â  Â  Â  Â  let htmlGrupos = nomesG.map(ng => {
Â  Â  Â  Â  Â  Â  const membros = gruposMat.filter(g => g["Nome do Grupo"] === ng)
Â  Â  Â  Â  Â  Â  Â  Â  .map(m => `<li>${m["Integrantes"]}</li>`).join('');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  return `
Â  Â  Â  Â  Â  Â  Â  Â  <details style="margin:5px 0; border:1px solid rgba(128,128,128,0.1); border-radius:8px;" ${statusOpen}>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <summary style="padding:8px; font-size:0.9em; font-weight:bold; color:var(--text-color); opacity:0.8;">${ng}</summary>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <ul style="font-size:0.85em; color:#bbb; padding-bottom:10px; list-style-type: none; padding-left: 15px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${membros}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </ul>
Â  Â  Â  Â  Â  Â  Â  Â  </details>`;
Â  Â  Â  Â  }).join('');

Â  Â  Â  Â  // Adicionado o atributo name="grupos" para o efeito de fechar os outros
Â  Â  Â  Â  container.innerHTML += `
Â  Â  Â  Â  Â  Â  <details class="secao-retratil" name="grupos" ${statusOpen}>
Â  Â  Â  Â  Â  Â  Â  Â  <summary class="secao-titulo">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${mat.toUpperCase()} <span>â–¾</span>
Â  Â  Â  Â  Â  Â  Â  Â  </summary>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="padding: 5px 10px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${htmlGrupos}
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </details>`;
Â  Â  });

Â  Â  // Ativa o fechamento automÃ¡tico (Accordion)
Â  Â  setupAccordion("grupos");
}

// LÃ³gica da Busca
function filtrarGrupos() {
Â  Â  const termo = document.getElementById('inputBusca').value.toLowerCase();
Â  Â  const todosGrupos = dadosApp["Grupos"] || [];
Â  Â Â 
Â  Â  // Filtra se o termo estÃ¡ na MatÃ©ria, no Nome do Grupo ou nos Integrantes
Â  Â  const filtrados = todosGrupos.filter(g =>Â 
Â  Â  Â  Â  String(g["MatÃ©ria"]).toLowerCase().includes(termo) ||
Â  Â  Â  Â  String(g["Nome do Grupo"]).toLowerCase().includes(termo) ||
Â  Â  Â  Â  String(g["Integrantes"]).toLowerCase().includes(termo)
Â  Â  );
Â  Â Â 
Â  Â  renderizarGrupos(filtrados);
}

Â  Â  function abrirLinks() {
Â  Â  Â  Â  const corpo = document.getElementById('modal-corpo');
Â  Â  Â  Â  document.getElementById('modal-titulo').innerText = "Portal de Aulas Online";
Â  Â  Â  Â  const itens = dadosApp["Links"] || [];
Â  Â  Â  Â  if (itens.length === 0) {
Â  Â  Â  Â  Â  Â  corpo.innerHTML = "<p style='text-align:center; opacity:0.5; padding:20px;'>Nenhum link agendado.</p>";
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  corpo.innerHTML = itens.map(i => {
Â  Â  Â  Â  Â  Â  Â  Â  const agora = new Date();
Â  Â  Â  Â  Â  Â  Â  Â  const [d, m, a] = i["Data"].split('/');
Â  Â  Â  Â  Â  Â  Â  Â  const [hh, mm] = i["HorÃ¡rio"].split(':');
Â  Â  Â  Â  Â  Â  Â  Â  const dataAula = new Date(a, m - 1, d, hh, mm);
Â  Â  Â  Â  Â  Â  Â  Â  let btnCor = (agora >= dataAula) ? "#28a745" : "#007bff";
Â  Â  Â  Â  Â  Â  Â  Â  let status = (agora >= dataAula) ? "â— AO VIVO" : "âŒ› AGENDADA";
Â  Â  Â  Â  Â  Â  Â  Â  let url = i["Url"].startsWith('http') ? i["Url"] : 'https://' + i["Url"];

Â  Â  Â  Â  Â  Â  Â  Â  return `<div class="item-lista" style="flex-direction:column; align-items:flex-start; border-left: 5px solid ${btnCor};">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex; justify-content:space-between; width:100%;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <b>${i["Materia"]}</b>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style="color:${btnCor}; font-size:0.7em; font-weight:bold;">${status}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="margin: 5px 0; font-size:0.85em; opacity:0.8;">ğŸ—“ï¸ ${i["Data"]} - ${i["HorÃ¡rio"]}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <a href="${url}" target="_blank" style="background:${btnCor}; color:white; text-decoration:none; padding:12px; border-radius:10px; width:100%; text-align:center; font-weight:bold; margin-top:10px;">${agora >= dataAula ? 'ACESSAR AGORA' : 'ABRIR LINK'}</a>
Â  Â  Â  Â  Â  Â  Â  Â  </div>`;
Â  Â  Â  Â  Â  Â  }).join('');
Â  Â  Â  Â  }
Â  Â  Â  Â  document.getElementById('meuModal').style.display = 'flex';
Â  Â  }

Â  Â  // ENVIO PARA A PLANILHA
Â  Â  async function enviarDados(tipo) {
Â  Â  Â  Â  const msgDiv = tipo === 'Links' ? document.getElementById('msgLink') : document.getElementById('msgAviso');
Â  Â  Â  Â  msgDiv.innerText = "Enviando...";
Â  Â  Â  Â  msgDiv.style.color = "orange";

Â  Â  Â  Â  let payload = { aba: tipo };
Â  Â  Â  Â  if (tipo === 'Links') {
Â  Â  Â  Â  Â  Â  payload.senha = document.getElementById('senhaLink').value;
Â  Â  Â  Â  Â  Â  payload.data = document.getElementById('dataLink').value;
Â  Â  Â  Â  Â  Â  payload.horario = document.getElementById('horaLink').value;
Â  Â  Â  Â  Â  Â  payload.materia = document.getElementById('materiaLink').value;
Â  Â  Â  Â  Â  Â  payload.url = document.getElementById('urlLink').value;
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  payload.senha = document.getElementById('senhaAviso').value;
Â  Â  Â  Â  Â  Â  payload.titulo = document.getElementById('tituloAviso').value;
Â  Â  Â  Â  Â  Â  payload.mensagem = document.getElementById('textoAviso').value;
Â  Â  Â  Â  }

Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  await fetch(URL_API, { method: 'POST', mode: 'no-cors', body: JSON.stringify(payload) });
Â  Â  Â  Â  Â  Â  msgDiv.innerText = "Enviado com Sucesso!";
Â  Â  Â  Â  Â  Â  msgDiv.style.color = "#28a745";
Â  Â  Â  Â  Â  Â  setTimeout(() => location.reload(), 2000);
Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  msgDiv.innerText = "Erro na conexÃ£o.";
Â  Â  Â  Â  Â  Â  msgDiv.style.color = "red";
Â  Â  Â  Â  }
Â  Â  }
</script>
</body>
</html>
